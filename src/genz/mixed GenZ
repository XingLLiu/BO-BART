mixture_genz <- function(x_c){
  
  gen_0 <- copeak
  gen_1 <- disc
  dim <- ncol(x_c)
  
  c <- x_c[ ,dim]
  xx <- x_c[ ,1 : (dim - 1)]
  
  if (is.matrix(xx) == FALSE) { 
    
    xx <- matrix(xx) 
    
  }
  
  indices_0 <- which(c == 0)
  indices_1 <- which(c == 1)
  
  y_0 <- as.numeric(gen_0( xx[indices_0, ] ))
  y_1 <- as.numeric(gen_1( xx[indices_1, ] ))
  
  y <- rep(0, nrow(xx))
  y[indices_0] <- y_0
  y[indices_1] <- y_1
  
  return (y)
  
}
