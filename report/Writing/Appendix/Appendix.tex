\subsection*{Bayesian Quadrature with Gaussian Processes}
In previous literature, $p(x)$ is assumed to be Gaussian. For the Genz functions, $p(x)$ is uniform. Following Osborne \cite{GPSQ} and Duvenaud\footnote{\url{https://www.cs.toronto.edu/~duvenaud/talks/intro\_bq.pdf}} we write
\begin{equation}
    Z = \int f(x) p(x) dx,
\label{eqn:BQwithGP}
\end{equation}
where we have a GP prior over $f$
\begin{equation}
    f \sim \mathcal{GP}(0,k(\cdot,\cdot)).
\end{equation}
    
Given samples $x_1, \ldots, x_n$ we can calculate \cite{Rasmussen:2005:GPM:1162254}
\begin{equation}
    E_{\mbox{GP}}\left[Z | f(x_1), \ldots, f(x_n)\right] = z^{\top} K^{-1}\pmb{f},
\end{equation}
where $z = [z_1, \ldots, z_n]^{\top}$ and $z_i = \int k(x,x_i)p(x)dx$, and $\pmb{f} = (f(x_1),..,f(x_n))^{\top}$. 
Sequential Bayesian Quadrature proceeds by finding the point $x$ that minimizes the variance of our estimate of $Z$
\begin{equation}
    Var_{\mbox{GP}}\left[Z | f(x_1), \ldots, f(x_n)\right] = \int \int k(x,x')p(x)p(x')dxdx' - z^{\top}K^{-1}z. 
\end{equation}

This does not depend on the values of the function at the points. For a given $k(x,x')$ and $p(x)$, we choose the point $x^*$
\begin{equation}
    \mbox{argmax}_{x^*} Var_{\mbox{GP}}\left[Z | f(x_1), \ldots, f(x_n), f(x^*) \right] 
\end{equation}

We will thus also need to calculate this double integral for $p(x)$ uniform.

Let us assume that we use the Gaussian kernel:
\begin{equation}
    k(x,x') = exp(-\|x-x'\|^2/2).
\end{equation}

For starters, we assume we are in one dimension with $p(x) = 1$ on the unit interval.
Thus we can calculate
\begin{align}
    z_i & = \int_{0}^1 k(x,x_i) dx \\
    & = \int_0^1 \exp(-\|x-x_i\|^2/2) dx, \\
\end{align}
which is computable using \texttt{pmvnorm} (in the \texttt{mvtnorm} package) in R.

For the double integral
\begin{align}
    & \x \int k(x,x')p(x)p(x')dxdx' \\
    & = \int_0^1 \int_0^1 \exp(-\|x - x'\|^2/2) dx dx', \\
\label{eq:double-integral}
\end{align}
and we have
\begin{align}
    & \mbox{argmin}_{x^*} Var_{\mbox{GP}}\left[Z | f(x_1), \ldots, f(x_n), f(x^*) \right]  \\
    & = \mbox{argmin}_{x^*}  \int_0^1 \int_0^1 \exp(-\|x - x'\|^2/2) dx dx' - z^{*\top}K^{-1}z^* \\
 & = \mbox{argmin}_{x^*}  - z^{*\top}K^{-1}z^*,
 \label{eq:sequestial desigh var}
\end{align}
where $z^* = \int_0^1 k(x, x^*) dx$, and Eq.~\eqref{eq:sequestial desigh var} follows as the double integral does not depend on $x^*$. In practice, although the function values obtained are noise-free, we add a jitter of value $10^{-6}$ to $K$ when inverting the matrix for numerical stability.

Note that the double integral in the one-dimensional case (although not required when implementing the sequential design) can be computed by noticing that \cite{wolframalpha}
\begin{align}
    \int_0^1 \int_0^1 \exp(-\|x - x'\|^2/2) dx dx'
    = \sqrt{\pi} \cdot \text{erf}(1) - 1 + \frac{1}{e} \approx 0.861528,
    \label{eq:doubleintegral}
\end{align}
where erf stands for the error function 
\begin{align}
    \text{erf}(x) = \frac{1}{\sqrt{\pi}}\int_{-x}^{x} e^{-t^2}.
\end{align}
Note that for $\pmb{x}$, $\pmb{x}^'$ $\in$ $[0,1]^d$, the integration becomes:
\begin{align}
    \int_{[0,1]^d}\int_{[0,1]^d}  \exp(-\| \pmb{x} - \pmb{x}' \|^2/2) d\pmb{x} d\pmb{x}' = \left[\int_0^1 \int_0^1 \exp(-\|x - x'\|^2/2) dx dx'\right] ^ d,
\end{align}
which can be computed quickly given the one-dimensional result in Eq.~\eqref{eq:doubleintegral}. 